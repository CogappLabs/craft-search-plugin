document.body.addEventListener("htmx:afterSwap",t=>{const e=t.detail?.target;if(!e)return;const r=e.classList.contains("sdf-sprig-root")?e:e.querySelector(".sdf-sprig-root");if(!r)return;const s=r.closest(".search-document-field");if(!s)return;const n={documentId:r.dataset.documentId??"",sectionHandle:r.dataset.sectionHandle??"",entryTypeHandle:r.dataset.entryTypeHandle??""};for(const[a,c]of Object.entries(n)){const o=s.querySelector(`[data-sdf-field="${a}"]`);o&&(o.value=c)}});document.body.addEventListener("keydown",t=>{const e=t.target;if(!e.classList.contains("sdf-query"))return;const r=e.closest(".search-document-field");if(!r)return;const s=r.querySelectorAll(".sdf-result-item");if(!s.length&&t.key!=="Escape")return;const n=r.querySelector(".sdf-results");let a=-1;switch(s.forEach((c,o)=>{c.classList.contains("sdf-active")&&(a=o)}),t.key){case"ArrowDown":t.preventDefault(),i(s,a<s.length-1?a+1:0,e);break;case"ArrowUp":t.preventDefault(),i(s,a>0?a-1:s.length-1,e);break;case"Enter":t.preventDefault(),a>=0&&a<s.length&&s[a].querySelector(".sdf-result-btn")?.click();break;case"Escape":t.preventDefault(),n&&n.classList.add("hidden"),s.forEach(c=>{c.classList.remove("sdf-active")}),e.removeAttribute("aria-activedescendant");break}});function i(t,e,r){t.forEach((s,n)=>{s.classList.toggle("sdf-active",n===e)}),e>=0&&t[e]?(r.setAttribute("aria-activedescendant",t[e].id),t[e].scrollIntoView({block:"nearest"})):r.removeAttribute("aria-activedescendant")}
