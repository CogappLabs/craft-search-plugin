document.body.addEventListener("htmx:configRequest",t=>{const e=t.detail?.elt;if(!e?.classList.contains("sdf-query"))return;const s=t.detail.parameters;s.query=e.value});document.body.addEventListener("htmx:afterSettle",t=>{const e=t.detail?.target;if(!e)return;const s=e.classList.contains("sdf-sprig-root")?e:e.querySelector(".sdf-sprig-root");if(!s)return;const a=s.closest(".search-document-field");if(!a)return;const r={documentId:s.dataset.documentId??"",sectionHandle:s.dataset.sectionHandle??"",entryTypeHandle:s.dataset.entryTypeHandle??""};for(const[n,c]of Object.entries(r)){const o=a.querySelector(`[data-sdf-field="${n}"]`);o&&(o.value=c)}});document.body.addEventListener("keydown",t=>{const e=t.target;if(!e.classList.contains("sdf-query"))return;const s=e.closest(".search-document-field");if(!s)return;const a=s.querySelectorAll(".sdf-result-item");if(!a.length&&t.key!=="Escape")return;let r=-1;switch(a.forEach((n,c)=>{n.classList.contains("sdf-active")&&(r=c)}),t.key){case"ArrowDown":t.preventDefault(),i(a,r<a.length-1?r+1:0,e);break;case"ArrowUp":t.preventDefault(),i(a,r>0?r-1:a.length-1,e);break;case"Enter":t.preventDefault(),r>=0&&r<a.length&&a[r].querySelector(".sdf-result-btn")?.click();break;case"Escape":t.preventDefault(),s.querySelector(".sdf-results")?.classList.add("hidden"),a.forEach(n=>{n.classList.remove("sdf-active")}),e.removeAttribute("aria-activedescendant");break}});function i(t,e,s){t.forEach((a,r)=>{a.classList.toggle("sdf-active",r===e)}),e>=0&&t[e]?(s.setAttribute("aria-activedescendant",t[e].id),t[e].scrollIntoView({block:"nearest"})):s.removeAttribute("aria-activedescendant")}
